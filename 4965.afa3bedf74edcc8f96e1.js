(self.webpackChunkPetland=self.webpackChunkPetland||[]).push([[4965],{4965:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Tab3PageModule:()=>V});var i=n(2859),o=n(8583),s=n(3679),r=n(9895),a=n(9765),c=n(3190),l=n(5257),d=n(6782),p=n(4762),h=n(7716),u=n(542),g=n(3542),m=n(1911),f=n(7556),b=n(9866);function v(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"ion-icon",21),h.NdJ("click",function(){h.CHM(t);const e=h.oxw();return e.onBack.emit(e.data)}),h.qZA()}}function x(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"ion-icon",23),h.NdJ("click",function(){h.CHM(t);const e=h.oxw(2);return e.onEdit.emit(e.data)}),h.qZA()}}function w(t,e){if(1&t&&(h.TgZ(0,"div"),h.YNc(1,x,1,0,"ion-icon",22),h.qZA()),2&t){const t=h.oxw();h.xp6(1),h.Q6J("ngIf",t.isAdmin||t.isMine)}}function O(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"input",24),h.NdJ("change",function(e){return h.CHM(t),h.oxw().fileChangeEvent(e)}),h.qZA()}}function y(t,e){1&t&&(h.TgZ(0,"figcaption",25),h._UZ(1,"img",26),h.qZA())}function C(t,e){1&t&&h._UZ(0,"ion-icon",27)}function Z(t,e){if(1&t&&(h.TgZ(0,"div",28),h.TgZ(1,"div",29),h.TgZ(2,"b"),h._uU(3),h.qZA(),h.qZA(),h._UZ(4,"hr"),h.TgZ(5,"table"),h.TgZ(6,"tr",30),h.TgZ(7,"td"),h._uU(8,"Ch\u1ee9c danh:"),h.qZA(),h.TgZ(9,"td"),h._uU(10),h.qZA(),h.qZA(),h.TgZ(11,"tr"),h.TgZ(12,"td"),h._uU(13,"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i:"),h.qZA(),h.TgZ(14,"td"),h._uU(15),h.qZA(),h.qZA(),h.TgZ(16,"tr"),h.TgZ(17,"td"),h._uU(18,"\u0110\u1ecba ch\u1ec9:"),h.qZA(),h.TgZ(19,"td"),h._uU(20),h.qZA(),h.qZA(),h.TgZ(21,"tr"),h.TgZ(22,"td"),h._uU(23,"Tr\u1ea1ng th\xe1i:"),h.qZA(),h.TgZ(24,"td"),h._uU(25),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&t){const t=h.oxw();h.xp6(3),h.Oqu(t.fullName),h.xp6(7),h.Oqu(t.nameRole),h.xp6(5),h.Oqu(t.data.phone),h.xp6(5),h.Oqu(t.displayAddress),h.xp6(5),h.Oqu(t.displayStatus)}}function A(t,e){if(1&t&&(h.TgZ(0,"div",31),h.TgZ(1,"div",29),h.TgZ(2,"b"),h._uU(3),h.qZA(),h.qZA(),h.qZA()),2&t){const t=h.oxw();h.xp6(3),h.Oqu(t.fullName)}}function _(t,e){if(1&t&&(h.TgZ(0,"div",32),h.TgZ(1,"ion-row"),h.TgZ(2,"ion-col"),h.TgZ(3,"ion-select",33),h.TgZ(4,"ion-select-option",34),h._uU(5,"Gi\xe1m \u0111\u1ed1c"),h.qZA(),h.TgZ(6,"ion-select-option",35),h._uU(7,"B\xe1c s\u0129"),h.qZA(),h.TgZ(8,"ion-select-option",36),h._uU(9,"Cashier"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&t){const t=h.oxw();h.xp6(3),h.Q6J("formControlName",t.FormField.role)}}function M(t,e){if(1&t&&(h.TgZ(0,"div",37),h._UZ(1,"input",38),h.qZA()),2&t){const t=h.oxw();h.xp6(1),h.Q6J("formControlName",t.FormField.phone)}}function T(t,e){if(1&t&&(h.TgZ(0,"div",37),h._UZ(1,"input",39),h.qZA()),2&t){const t=h.oxw();h.xp6(1),h.Q6J("formControlName",t.FormField.address)}}function P(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"button",40),h.NdJ("click",function(){return h.CHM(t),h.oxw(2).acctiveOrBlockUser()}),h._uU(1),h.qZA()}if(2&t){const t=h.oxw(2);h.xp6(1),h.hij(" ",t.nameBtnActive," ")}}function N(t,e){if(1&t&&(h.TgZ(0,"div"),h.YNc(1,P,2,1,"button",19),h.qZA()),2&t){const t=h.oxw();h.xp6(1),h.Q6J("ngIf",t.viewOnly)}}function k(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"button",40),h.NdJ("click",function(){return h.CHM(t),h.oxw().register()}),h._uU(1," Ho\xe0n th\xe0nh "),h.qZA()}}function q(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"button",41),h.NdJ("click",function(){return h.CHM(t),h.oxw().deleteUser()}),h._uU(1," X\xf3a nh\xe2n vi\xean "),h.qZA()}}var S=(()=>(function(t){t.role="role",t.passport="passport",t.displayName="displayName",t.phone="phone",t.address="address",t.photoURL="photoURL",t.active="active"}(S||(S={})),S))();let I=(()=>{class t{constructor(t,e,n,i,o,s,r){this.auth=t,this.alertCtrl=e,this.modalCtrl=n,this.spiner=i,this.router=o,this.alertController=s,this.formBuilder=r,this.destroy$=new a.xQ,this.FormField=S,this.submited=!1,this.nameBtnActive="",this.nameRole="",this.isMine=!1,this.fullName="",this.displayAddress="",this.displayStatus="",this.onSubmit=new h.vpe,this.onDelete=new h.vpe,this.onEdit=new h.vpe,this.onBack=new h.vpe,this.viewOnly=!1,this.title="Ch\u1ec9nh s\u1eeda th\xf4ng tin",this.popup=!1}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete()}ngOnInit(){this.auth.user$.subscribe(t=>{this.currAcc=t,this.isAdmin=this.currAcc.role===m.u.ADMIN,this.isMine=this.data.id==this.currAcc.id}),this.forworder(),this.form=this.formBuilder.group({[S.role]:[{value:this.data.role||"BLOCK",disabled:this.viewOnly},[s.kI.required]],[S.displayName]:[{value:this.data.displayName,disabled:this.viewOnly},[s.kI.required]],[S.phone]:[this.data.phone,[s.kI.required,s.kI.pattern(/((09|03|07|08|05)+([0-9]{8})\b)/g)]],[S.address]:[{value:this.data.address,disabled:this.viewOnly}],[S.photoURL]:[{value:this.data.photoURL||u.c,disabled:this.viewOnly}],[S.active]:[{value:this.data.active?"\u0110ANG HO\u1ea0T \u0110\u1ed8NG":"\u0110ANG KH\xd3A",disabled:this.viewOnly},[s.kI.required]]}),this.viewOnly&&this.form.controls[S.phone].disable(),this.nameBtnActive=this.data.active?"KH\xd3A T\xc0I KHO\u1ea2N":"M\u1ede T\xc0I KHO\u1ea2N",this.nameRole=this.data.role==m.u.ADMIN?"GI\xc1M \u0110\u1ed0C":this.data.role==m.u.DOCTOR?"B\xc1C S\u0128":"CASHIER",this.fullName=this.data.displayName.toUpperCase(),this.displayAddress=""==this.data.address?"Ch\u01b0a c\u1eadp nh\u1eadt":this.data.address,this.displayStatus=this.data.active?"\u0110ANG HO\u1ea0T \u0110\u1ed8NG":"\u0110ANG KH\xd3A"}forworder(){if(this.popup){const t={onSubmit:this.onSubmit,onEdit:this.onEdit,onBack:this.onBack,onDelete:this.onDelete};Object.keys(t).forEach(e=>{t[e].pipe((0,d.R)(this.destroy$)).subscribe(t=>{this.modalCtrl.dismiss({action:e,state:t})})})}}register(){if(this.submited=!0,this.form.valid){const t=this.form.getRawValue(),e=this.form.getRawValue();t.active="\u0110ANG HO\u1ea0T \u0110\u1ed8NG"==e.active,this.onSubmit.emit(Object.assign(this.data,t))}}acctiveOrBlockUser(){const t=this.form.getRawValue(),e=this.form.getRawValue();t.active="\u0110ANG HO\u1ea0T \u0110\u1ed8NG"!=e.active,this.onSubmit.emit(Object.assign(this.data,t))}deleteUser(){return(0,p.mG)(this,void 0,void 0,function*(){let t=yield this.alertCtrl.create({header:"X\xe1c nh\u1eadn",message:"B\u1ea1n c\xf3 mu\u1ed1n x\xf3a t\xe0i kho\u1ea3n n\xe0y kh\xf4ng ?",buttons:[{text:"Kh\xf4ng",role:"cancel",cssClass:"secondary",handler:t=>{console.log("Confirm Cancel: blah")}},{text:"C\xf3",handler:()=>{const t=this.form.getRawValue(),e=this.form.getRawValue();t.active="\u0110ANG HO\u1ea0T \u0110\u1ed8NG"==e.active,this.onDelete.emit(Object.assign(this.data,t))}}]});yield t.present()})}close(){return(0,p.mG)(this,void 0,void 0,function*(){yield this.modalCtrl.dismiss()})}notifyCreate(t,e){this.alertController.create({mode:"ios",header:t,message:e,buttons:[{text:"OK"}]}).then(t=>{t.present()})}fileChangeEvent(t){return(0,p.mG)(this,void 0,void 0,function*(){if(this.viewOnly)return;const e=yield this.modalCtrl.create({component:g.s,cssClass:"modal-custom-class",showBackdrop:!1,componentProps:{imageChangedEvent:t}});yield e.present();const{data:n}=yield e.onWillDismiss();n&&"object"==typeof n&&n.data&&this.form.controls[S.photoURL].setValue(n.data)})}}return t.\u0275fac=function(e){return new(e||t)(h.Y36(f.e),h.Y36(i.Br),h.Y36(i.IN),h.Y36(b.t2),h.Y36(r.F0),h.Y36(i.Br),h.Y36(s.qu))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-user-edit-c"]],inputs:{data:"data",currAcc:"currAcc",viewOnly:"viewOnly",isAdmin:"isAdmin",title:"title",popup:"popup"},outputs:{onSubmit:"onSubmit",onDelete:"onDelete",onEdit:"onEdit",onBack:"onBack"},decls:28,vars:18,consts:[["fullscreen","true"],[1,"ion-padding","form-content"],[1,"ion-padding","form-validation",3,"formGroup"],[2,"display","flex","position","relative","justify-content","center","align-items","center"],["class","icon-back","name","arrow-back-outline",3,"click",4,"ngIf"],[1,"title-name"],[4,"ngIf"],[1,"personal-image"],[1,"label"],["type","file",3,"change",4,"ngIf"],[1,"personal-figure"],["alt","avatar",1,"personal-avatar",3,"src"],["class","personal-figcaption",4,"ngIf"],["class","avatar-custom-icon","name","camera-outline",4,"ngIf"],["class","panel",4,"ngIf"],["class","wrap-input","style","margin-bottom: 16px;",4,"ngIf"],["class","wrap-input","style","box-shadow: 0 4px 6px 0 #3947521f;",4,"ngIf"],["class","wrap-input",4,"ngIf"],[1,"container-form-btn"],["class","form-btn custom-font",3,"click",4,"ngIf"],["class","form-btn custom-font delete",3,"click",4,"ngIf"],["name","arrow-back-outline",1,"icon-back",3,"click"],["style","\n                position: absolute;\n                top: 2px;\n                right: 0px;\n                color: var(--color2);\n                font-size: 21px;\n                cursor: pointer;\n            ","name","create-outline",3,"click",4,"ngIf"],["name","create-outline",2,"position","absolute","top","2px","right","0px","color","var(--color2)","font-size","21px","cursor","pointer",3,"click"],["type","file",3,"change"],[1,"personal-figcaption"],["src","assets/pets/camera-white.png"],["name","camera-outline",1,"avatar-custom-icon"],[1,"panel"],[1,"lable-role"],[1,"companyItem"],[1,"wrap-input",2,"margin-bottom","16px"],[1,"wrap-input",2,"box-shadow","0 4px 6px 0 #3947521f"],[3,"formControlName"],["value","ADMIN"],["value","DOCTOR"],["value","CASHIER"],[1,"wrap-input"],["type","text","type","text","name","phone","placeholder","Nh\u1eadp s\u1ed1 \u0111i\u1ec7n tho\u1ea1i",1,"input",3,"formControlName"],["type","text","type","text","name","address","placeholder","Nh\u1eadp \u0111\u1ecba ch\u1ec9",1,"input",3,"formControlName"],[1,"form-btn","custom-font",3,"click"],[1,"form-btn","custom-font","delete",3,"click"]],template:function(t,e){1&t&&(h.TgZ(0,"ion-content",0),h.TgZ(1,"div",1),h.TgZ(2,"form",2),h.TgZ(3,"ion-row"),h.TgZ(4,"ion-col"),h.TgZ(5,"div",3),h.YNc(6,v,1,0,"ion-icon",4),h.TgZ(7,"div",5),h._uU(8),h.qZA(),h.YNc(9,w,2,1,"div",6),h.qZA(),h.qZA(),h.qZA(),h.TgZ(10,"ion-row"),h.TgZ(11,"ion-col"),h.TgZ(12,"div",7),h.TgZ(13,"label",8),h.YNc(14,O,1,0,"input",9),h.TgZ(15,"figure",10),h._UZ(16,"img",11),h.YNc(17,y,2,0,"figcaption",12),h.qZA(),h.qZA(),h.YNc(18,C,1,0,"ion-icon",13),h.qZA(),h.qZA(),h.qZA(),h.YNc(19,Z,26,5,"div",14),h.YNc(20,A,4,1,"div",15),h.YNc(21,_,10,1,"div",16),h.YNc(22,M,2,1,"div",17),h.YNc(23,T,2,1,"div",17),h.TgZ(24,"div",18),h.YNc(25,N,2,1,"div",6),h.YNc(26,k,2,0,"button",19),h.YNc(27,q,2,0,"button",20),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&t&&(h.xp6(2),h.ekj("submited",e.submited),h.Q6J("formGroup",e.form),h.xp6(4),h.Q6J("ngIf",e.popup),h.xp6(2),h.hij(" ",e.title," "),h.xp6(1),h.Q6J("ngIf",e.viewOnly),h.xp6(5),h.Q6J("ngIf",!e.viewOnly),h.xp6(2),h.Q6J("src",e.form.controls[e.FormField.photoURL].value,h.LSH),h.xp6(1),h.Q6J("ngIf",!e.viewOnly),h.xp6(1),h.Q6J("ngIf",!e.viewOnly),h.xp6(1),h.Q6J("ngIf",e.viewOnly),h.xp6(1),h.Q6J("ngIf",!e.viewOnly),h.xp6(1),h.Q6J("ngIf",!e.viewOnly&&e.isAdmin),h.xp6(1),h.Q6J("ngIf",!e.viewOnly),h.xp6(1),h.Q6J("ngIf",!e.viewOnly),h.xp6(2),h.Q6J("ngIf",e.isAdmin&&!e.isMine),h.xp6(1),h.Q6J("ngIf",!e.viewOnly),h.xp6(1),h.Q6J("ngIf",!e.viewOnly&&e.isAdmin))},directives:[i.W2,s._Y,s.JL,s.sg,i.Nd,i.wI,o.O5,i.gu,i.t9,i.QI,s.JJ,s.u,i.n0,s.Fj],styles:["ion-toolbar[_ngcontent-%COMP%]{--background:#0000}ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-weight:900}ion-toolbar[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:40px 0 20px;font-weight:700}ion-toolbar[_ngcontent-%COMP%]   .back-circle[_ngcontent-%COMP%]{background:#78bec31f;z-index:-1;width:200px;height:200px;position:absolute;border-radius:50%;margin-left:auto;margin-right:auto;left:0;right:0;bottom:0}ion-content[_ngcontent-%COMP%]{--background:var(--color1)}.back-blob[_ngcontent-%COMP%]{z-index:-1;width:600px;position:absolute;left:-50%;top:0}.wrap-input[_ngcontent-%COMP%]{border-radius:20px;margin-bottom:18px}.container-form-btn[_ngcontent-%COMP%], .form-content[_ngcontent-%COMP%]{display:flex;justify-content:center}.form-content[_ngcontent-%COMP%]{align-content:center;align-items:center}.form-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:100%;max-width:500px}.form-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-color:var(--color2)}.form-content[_ngcontent-%COMP%]   .title-name[_ngcontent-%COMP%]{font-family:var(--ion-font-family,inherit);font-style:normal;font-weight:700;font-size:24px;line-height:28px;padding-bottom:15px}.form-btn[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:0 20px;width:100%;height:42px;background-color:#78bec3;border-radius:20px;font-size:14px;color:#fff;transition:all .4s;box-shadow:0 10px 30px 0 #39475280}.form-btn[_ngcontent-%COMP%]:hover{background-color:#28333b;box-shadow:0 10px 30px 0 #394752cc}.delete[_ngcontent-%COMP%]{margin-left:6px;background-color:var(--color5)}@media screen and (min-width: 1200px){.form-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:100%;max-width:500px;box-shadow:0 21px 37px #00000017;border-radius:30px;height:calc(100vh - 0px);display:flex;flex-direction:column;padding:34px;max-width:390px;justify-content:flex-start;overflow-y:auto}}.lable-role[_ngcontent-%COMP%]{text-align:center;color:green;font-size:20px;margin-bottom:5px}.personal-image[_ngcontent-%COMP%]{text-align:center;position:relative}.personal-image[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{display:none}.personal-figure[_ngcontent-%COMP%]{position:relative;width:120px;height:120px}.personal-avatar[_ngcontent-%COMP%]{cursor:pointer;width:120px;height:120px;box-sizing:border-box;border-radius:100%;border:2px solid var(--color2);box-shadow:0 2px 4px 0 #0003;transition:all .3s ease-in-out}.personal-avatar[_ngcontent-%COMP%]:hover{box-shadow:0 2px 4px 0 #00000080}.personal-figcaption[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:0;width:inherit;height:inherit;border-radius:100%;opacity:0;background-color:#0000;transition:all .3s ease-in-out}.personal-figcaption[_ngcontent-%COMP%]:hover{opacity:1;background-color:#00000080}.personal-figcaption[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{margin-top:32.5px;width:50px;height:50px}.avatar-custom-icon[_ngcontent-%COMP%]{position:absolute;bottom:32px;right:110px;color:var(--color1);background:var(--color2);border-radius:50%;padding:4px}.title-name[_ngcontent-%COMP%]{font-weight:700;font-size:18px;line-height:21px;text-align:center;padding-bottom:12px}.icon-back[_ngcontent-%COMP%]{position:absolute;font-size:30px;top:-2px;left:0;color:var(--color2);z-index:2}hr[_ngcontent-%COMP%]{margin:auto;height:auto;width:60%}.role[_ngcontent-%COMP%]{text-align:center;margin-bottom:6px 0 30px}ul[_ngcontent-%COMP%]{list-style:none;height:auto;text-align:left;padding:0 .2rem;margin:1rem 1rem 2rem 0;letter-spacing:1px;line-height:2.5rem}#address[_ngcontent-%COMP%]{padding-left:6rem}#age[_ngcontent-%COMP%]{padding-left:4.3rem}#phone[_ngcontent-%COMP%]{padding-left:3.2rem}#status[_ngcontent-%COMP%]{padding-left:4.5rem}@media (max-width: 780px){ul[_ngcontent-%COMP%]{flex-shrink:1;padding-left:4rem;font-size:.85rem}}table[_ngcontent-%COMP%]{border-collapse:collapse;width:-webkit-fill-available}tr[_ngcontent-%COMP%]{border-bottom:1px solid #0000001a;height:3.5rem}tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]:first-child{font-weight:600;font-size:1.25rem;line-height:1.75rem;color:#0b131a;padding-left:2rem;width:50%}tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]:first-child, tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]:last-child{font-family:Inter;font-style:normal}tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]:last-child{font-weight:400;font-size:1rem;line-height:1.5rem;color:#5e5e5e}span[_ngcontent-%COMP%]{display:block;font-family:Inter;padding:3em}span[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{color:#0184ff}"]}),t})();var U=n(2818),Y=n(6011),J=n(3071);function R(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"app-user-edit-c",1),h.NdJ("onDelete",function(e){return h.CHM(t),h.oxw().delete(e)})("onSubmit",function(e){return h.CHM(t),h.oxw().submit(e)}),h.qZA()}if(2&t){const t=h.oxw();h.Q6J("data",t.data)}}let B=(()=>{class t{constructor(t,e,n,i,o,s){this.mobileSupportServive=t,this.alertController=e,this.router=n,this.spinner=i,this.route=o,this.userService=s,this.destroy$=new a.xQ,this.route.params.pipe((0,c.w)(t=>this.userService.get(t.id).pipe((0,l.q)(1)))).subscribe(t=>{this.data=t,this.mobileSupportServive.toPopup(this.data,I,{viewOnly:!1}).pipe((0,d.R)(this.destroy$)).subscribe(t=>{switch(t.action){case"onSubmit":this.submit(t.state);break;case"onBack":this.router.navigate(["/home/tabs/tab3"]).then(()=>{this.mobileSupportServive.isMobile&&window.location.reload()});break;case"onDelete":this.delete(t.state)}})})}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete()}submit(t){this.spinner.show();let e=null;try{e=(0,U.Ll)(t.photoURL,`pet-${(new Date).getTime()}`)}catch(n){}null===e?(this.data=null,this.userService.update(t).pipe((0,d.R)(this.destroy$)).subscribe(()=>{this.notifyCreate("Th\xe0nh c\xf4ng","Th\xf4ng tin \u0111\xe3 \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt"),this.spinner.hide()})):(this.data=null,this.userService.uploadAvatar(e,t.id).pipe((0,c.w)(e=>this.userService.update(Object.assign(Object.assign({},t),{photoURL:e}))),(0,d.R)(this.destroy$)).subscribe(t=>{this.notifyCreate("Th\xe0nh c\xf4ng","Th\xf4ng tin \u0111\xe3 \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt"),this.spinner.hide()}))}delete(t){this.spinner.show(),this.userService.delete(t).then(()=>{this.router.navigate(["/home/tabs/tab3"]).then(t=>{this.spinner.hide(),window.location.reload()})})}notifyCreate(t,e){this.alertController.create({mode:"ios",header:t,message:e,buttons:[{text:"OK"}]}).then(t=>{t.present()})}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(h.Y36(Y.f),h.Y36(i.Br),h.Y36(r.F0),h.Y36(b.t2),h.Y36(r.gz),h.Y36(J.K))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-user-edit"]],features:[h._Bn([Y.f])],decls:1,vars:1,consts:[[3,"data","onDelete","onSubmit",4,"ngIf"],[3,"data","onDelete","onSubmit"]],template:function(t,e){1&t&&h.YNc(0,R,1,1,"app-user-edit-c",0),2&t&&h.Q6J("ngIf",e.data)},directives:[o.O5,I],styles:["app-user-edit-c[_ngcontent-%COMP%]{height:100vh}"]}),t})();function Q(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"app-user-edit-c",1),h.NdJ("onEdit",function(e){return h.CHM(t),h.oxw().edit(e)})("onSubmit",function(e){return h.CHM(t),h.oxw().submit(e)}),h.qZA()}if(2&t){const t=h.oxw();h.Q6J("viewOnly",t.viewOnly)("isAdmin",t.isAdmin)("data",t.data)("currAcc",t.currAcc)}}let E=(()=>{class t{constructor(t,e,n,i,o,s,r){this.auth=t,this.mobileSupportServive=e,this.alertController=n,this.router=i,this.spinner=o,this.route=s,this.userService=r,this.destroy$=new a.xQ,this.viewOnly=!0,this.isAdmin=!1,this.route.params.pipe((0,c.w)(t=>this.userService.get(t.id).pipe((0,l.q)(1)))).subscribe(t=>{this.data=t,this.auth.user$.subscribe(t=>{null!=t&&(this.currAcc=t,this.currAcc.role===m.u.ADMIN&&(this.isAdmin=!0)),this.mobileSupportServive.toPopup(this.data,I,{viewOnly:!0,isAdmin:this.isAdmin}).pipe((0,d.R)(this.destroy$)).subscribe(t=>{switch(t.action){case"onEdit":this.edit(t.state);break;case"onSubmit":this.submit(t.state);break;case"onBack":this.router.navigate(["/home/tabs/tab3"]).then(()=>{this.mobileSupportServive.isMobile&&window.location.reload()})}})})})}ngOnInit(){}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete()}submit(t){this.spinner.show();let e=null;try{e=(0,U.Ll)(t.photoURL,`pet-${(new Date).getTime()}`)}catch(n){}null===e?(this.data=null,this.userService.update(t).pipe((0,d.R)(this.destroy$)).subscribe(()=>{this.notifyCreate("Th\xe0nh c\xf4ng","Th\xf4ng tin \u0111\xe3 \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt"),this.spinner.hide()})):(this.data=null,this.userService.uploadAvatar(e,t.id).pipe((0,c.w)(e=>this.userService.update(Object.assign(Object.assign({},t),{photoURL:e}))),(0,d.R)(this.destroy$)).subscribe(t=>{this.notifyCreate("Th\xe0nh c\xf4ng","Th\xf4ng tin \u0111\xe3 \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt"),this.spinner.hide()}))}notifyCreate(t,e){this.alertController.create({mode:"ios",header:t,message:e,buttons:[{text:"OK",handler:()=>{this.router.navigate(["/home/tabs/tab3"]).then(()=>{this.mobileSupportServive.isMobile&&window.location.reload()})}}]}).then(t=>{t.present()})}edit(t){this.router.navigate(["/home/tabs/tab3/edit",t.id])}}return t.\u0275fac=function(e){return new(e||t)(h.Y36(f.e),h.Y36(Y.f),h.Y36(i.Br),h.Y36(r.F0),h.Y36(b.t2),h.Y36(r.gz),h.Y36(J.K))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-user-viewer"]],features:[h._Bn([Y.f])],decls:1,vars:1,consts:[["title","Th\xf4ng tin nh\xe2n vi\xean",3,"viewOnly","isAdmin","data","currAcc","onEdit","onSubmit",4,"ngIf"],["title","Th\xf4ng tin nh\xe2n vi\xean",3,"viewOnly","isAdmin","data","currAcc","onEdit","onSubmit"]],template:function(t,e){1&t&&h.YNc(0,Q,1,4,"app-user-edit-c",0),2&t&&h.Q6J("ngIf",e.data&&!e.mobileSupportServive.isMobile)},directives:[o.O5,I],styles:["app-user-edit-c[_ngcontent-%COMP%]{height:100vh}"]}),t})();var D=n(5917),z=n(4395),$=n(2838);const H=[{path:"",component:(()=>{class t{constructor(t,e,n){this.router=t,this.userService=e,this.auth=n,this.destroy$=new a.xQ,this.data=[],this.size=10,this.searchName=new a.xQ,this.keyWork="",this.title="Th\xeam nh\xe2n vi\xean",this.isAdmin=!1,this.item$=this.searchName.pipe((0,z.b)(250),(0,c.w)(t=>this.search(t))),this.init()}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete()}search(t){return(0,D.of)(this.data.filter(e=>-1!=(0,U.n8)(e.search.toUpperCase()).indexOf((0,U.n8)(t.toUpperCase()))).sort((t,e)=>t.fullName.localeCompare(e.fullName)).slice(0,this.size))}init(){this.userService.getAll().pipe((0,d.R)(this.destroy$)).subscribe(t=>{this.data=[...t.map(t=>({url:t.photoURL,fullName:t.displayName,desc:t.phone,search:t.displayName,id:t.uid}))],this.searchName.next("")})}scrollDownEnd(){this.size+=10,console.log("load more "+this.size),this.searchName.next(this.keyWork)}searchByName(t){this.size=10,this.keyWork=t,this.searchName.next(t)}selectRow(t){this.router.navigate(["/home/tabs/tab3/view",t.id])}create(t){console.log("create"),this.auth.signOut().then(()=>{this.router.navigate(["/forms/register"])})}}return t.\u0275fac=function(e){return new(e||t)(h.Y36(r.F0),h.Y36(J.K),h.Y36(f.e))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-tab3"]],decls:6,vars:5,consts:[[3,"fullscreen"],[2,"display","flex"],[3,"title","data","onScrollDownEnd","onCrate","onSelect","onSearch"],[1,"content-details"]],template:function(t,e){1&t&&(h.TgZ(0,"ion-content",0),h.TgZ(1,"div",1),h.TgZ(2,"app-list-c",2),h.NdJ("onScrollDownEnd",function(){return e.scrollDownEnd()})("onCrate",function(t){return e.create(t)})("onSelect",function(t){return e.selectRow(t)})("onSearch",function(t){return e.searchByName(t)}),h.ALo(3,"async"),h.qZA(),h.TgZ(4,"div",3),h._UZ(5,"ion-router-outlet"),h.qZA(),h.qZA(),h.qZA()),2&t&&(h.Q6J("fullscreen",!0),h.xp6(2),h.Q6J("title",e.title)("data",h.lcZ(3,3,e.item$)))},directives:[i.W2,$.Z,i.jP],pipes:[o.Ov],styles:["ion-content[_ngcontent-%COMP%]{--background:var(--color2)}.content-details[_ngcontent-%COMP%]{border-left:1px solid #dee2e6;flex:1;background:#fff;position:relative}.content-details[_ngcontent-%COMP%], .mobile-support[_ngcontent-%COMP%]{display:none}@media only screen and (min-device-width: 768px){.content-details[_ngcontent-%COMP%]{display:block}}"]}),t})(),children:[{path:"edit/:id",component:B},{path:"view/:id",component:E}]}];let F=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.oAB({type:t}),t.\u0275inj=h.cJS({imports:[[r.Bz.forChild(H)],r.Bz]}),t})();var j=n(581),G=n(7468),L=n(1368);let K=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.oAB({type:t}),t.\u0275inj=h.cJS({imports:[[o.ez,o.ez,s.u5,i.Pc,s.UX,L.T]]}),t})(),V=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.oAB({type:t}),t.\u0275inj=h.cJS({imports:[[i.Pc,o.ez,s.u5,j.e,F,G.Y,K]]}),t})()}}]);